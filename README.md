# seewo-yuanshen

利用 VBS 劫持快捷方式来为希沃白板替换启动图片

## 优点
- 不需要管理员权限（设置自启）
- 无需后台常驻

## 使用
### 安装
执行`Setup.hta`。如果你需要安装至如 `C:\Windows` 这样的目录，请以管理员身份运行

伪快捷方式文件名为 "希沃白板 5 .lnk"，与正常快捷方式 "希沃白板 5.lnk" 显示一样，但可以共存

### 卸载
- 1.执行 `{InstallPath}\Tool\first-aid-kit\aid.vbs`
- 2.删除安装目录

如果 `Tool` 文件夹不存在，你需要手动删除伪快捷方式，添加希沃白板（正常）快捷方式，然后再删除安装目录

### 切换图片
使用 `bin/manager.py` 的图片管理器

若要添加图片，请添加图片至 `bin/img/`，再向 `bin/img/` 添加图片信息
```
{
	"name":  "{图片名称}",
	"sha256":  "{图片的SHA256}",
	"brief":  "图片描述"
}
```
然后使用 `bin/manager.py` 切换

`bin/manager.py` 仅用于切换图片，删除该文件以及 `bin/img` 不会影响程序运行

### 工具
`解除文件锁定.ps1` 用于一键解除该文件夹的文件锁定，可在安装前运行  
`Tool\结束希沃白板进程.bat` 用于结束希沃白板进程。当希沃白板存在后台进程时，启动白板会直接切换至前台程序，不会显示启动图片  
`Tool\first-aid-kit\aid.vbs` 用于恢复正常的启动图片并重置快捷方式。也可以将其用作卸载程序  
`bin\manager.py` 用于切换启动图片  
`bin\img\to.ps1` 用于一键生成图片库  

所有的工具不会干预主程序的正常运行

## 目录结构
### 项目目录结构
```
SEEWO-YUANSHEN-MAIN
│  CreateShortcuts.vbs		创建伪快捷方式
│  LICENSE					许可证，该项目采用 Apache-2.0 license。欢迎大家 fork
│  README.md
│  Setup.hta				安装脚本
│  解除文件锁定.ps1			一键解除文件锁定
│
├─bin
│  │  base.vbs				基础脚本
│  │  checkEnvironment.vbs	检查环境
│  │  img.pngx				启动图片会替换成这个
│  │  img_backup.zip
│  │  manager.py			图片切换器
│  │  yuanshen.vbs			伪快捷方式链接该脚本。该脚本会先替换图片，再启动希沃白板
│  │
│  └─img
│          img.pngx			图片
│          ...
│          files.json		存储图片信息，供 "manager.py" 使用
│          to.ps1			一键生成图片库
│
└─Tool
    │  结束希沃白板进程.bat	结束希沃白板进程
    │
    └─first-aid-kit
        │  aid.vbs			重置启动图片+重置快捷方式
        │  README.md
        │
        └─bin
                backup.png.bak	原启动图片
                base.vbs		基础脚本，与 "binbase.vbs" 一样
                replace.vbs		重置启动图片
                shortcut.vbs	重置快捷方式
```

### files.json 目录结构
```
[
	{
		"name":  "{图片名称}",
		"sha256":  "{图片的SHA256}",
		"brief":  "图片描述"
	},
	...
]
```

程序不会强行校验sha256

## 适用版本
以下版本已在 Windows 10 专业版 22H2 已通过测试
- 5.2.0.2512
- 5.2.2.6111
- 5.2.2.8861
- 5.2.2.9633
- 5.2.3.1507
- 5.2.3.171
- 5.2.3.3534
- 5.2.3.695
- 5.2.4.8298
- 5.2.4.8527
- 5.2.4.8560
- 5.2.4.8760
- 5.2.4.9056
- 5.2.4.9120

若在某些环境与版本无法正常运行，请附带**系统版本**，**希沃白板版本**与**希沃白板安装目录**信息提交issue，蟹蟹

## 已知问题

本程序每次启动时都会遍布注册表查找希沃白板的安装路径，可能导致速度减慢（在现有的测试中，会比原版多个几百毫秒）

## 坑
所有代码都必须时 ASCII 编码，不然就会乱码
